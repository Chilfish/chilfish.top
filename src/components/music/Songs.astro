---
import Image from '../common/Image.astro'
import type { SongRecord } from '~/types'

type Props = {
  record: SongRecord
  idx: number
}

const { record, idx } = Astro.props

let index = `${idx}`
if (idx < 10)
  index = `0${idx}`
---

<a
  uno-bg={`${idx % 2 === 0 ? '#f7f9fc dark:dark-6' : '#f7f5f7 dark:dark-7'}`}
  uno-hover-bg={`${idx % 2 !== 0 ? '#f7f5f7 dark:dark-7' : '#f7f9fc dark:dark-6'}`}
  class="song"
  href={`https://music.163.com/song?id=${record.id}`}
  target="_blank"
  referrerpolicy="no-referrer"
>
  <div> { index } </div>

  <div class="h-12 w-12 flex-shrink-0">
    <Image
      class="h-12 w-12 rounded-md"
      alt={record.name}
      src={record.al.picUrl}
      width={48}
      height={48}
    />
  </div>

  <div class="flex flex-col gap-1">
    <div class="record-name">
      { record.name }
    </div>

    <div class="mt-2 truncate">
      { record.ar.map(a => a.name).join(', ') }
      -
      {record.al.name }
    </div>
  </div>

  { record.playCount > 0 && (
    <div class="duration">
      { record.playCount } æ¬¡
    </div>
  )}
</a>

<style>
.song {
  --uno: h-18 w-90vw flex items-center justify-between gap-3 rounded-md px-3 py-2 text-3 sm:w-40rem sm:text-3.5;
}

.record-name {
  --uno: text-4 truncate;
}

.duration {
  --uno: ml-auto min-w-fit flex items-center justify-end;
}
</style>
