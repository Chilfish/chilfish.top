---
title: 应用层
date: 2022-10-24
tags: [note, net]
---

> [DNS](DNS.md)、[HTTP](HTTP.md)

## 概述

网络应用是计算机网络存在的理由，也正是有一系列的应用需求，才会设计出相应的协议。而 **应用层** 是计算机网络体系结构的 **最顶层**，是 **设计和建立计算机网络的最终目的**，也是计算机网络中发展最快的

最常见的应用有如 **万维网 WWW**、**多媒体网络（音视频等）**、**文件传送 FTP 和 P2P 文件共享**、**电子邮件**、**域名解析** 等等

## 应用层协议原理

网络应用程序运行在 **处于网络边缘的不同端系统** 上，通过彼此之间的通信来完成某些需求

而开发一种新的网络应用首先要考虑的问题就是：**网络应用程序在各种端系统上的组织方式和他们之间的关系**。目前主要有两种：

- **客户端/服务器** (C/S)
- **对等方式** (P2P)

### 端系统之间的通信

#### 含义

`主机 A 和主机 B 进行通信` 实际上是指：“运行在主机 A 上的某个程序和运行在主机 B 上的另一个程序进行通信”。即 **主机 A 的某个进程和主机 B 上的另一个进程进行通信** 。简称为 **计算机之间通信**

#### 客户-服务器方式

客户服务器方式（`Client`／`Server` 方式）所描述的是进程之间服务和被服务的关系。客户和服务器都是指通信中所涉及的两个应用进程， **客户是请求方，服务器是提供方**

- **客户软件的特点：** 被用户调用后运行，按需地向服务端发送请求，因此 **用户程序必须知道服务器的 IP 地址**
- **服务器软件的特点：** 是一种专门用来提供某种服务的程序，可同时处理多个远地或本地客户的请求。 系统启动后即自动调用并**一直不断地运行着**，被动地**等待并接受来自各地的客户的通信请求**，因此服务器程序不需要知道客户程序的地址，而服务器的主机具有固定的 IP 地址

> **注意：** 客户与服务器的通信关系建立后，通信可以是双向的，客户和服务器都可以发送和接收数据

在 C/S 模式中，数据的分发采用专门的服务器，多个客户端都从此服务器获取数据

- **优点是：** 数据的一致性容易控制，系统也容易管理
- **缺点是：** 因为服务器的个数只有一个(即便有多个也非常有限)，系统容易出现单一失效点；单一服务器面对众多的客户端，由于 CPU 能力、内存大小、网络带宽的限制，可同时服务的客户端非常有限，可扩展性差

#### 对等连接方式

**对等连接** (`peer-to-peer`，简写为 **P2P** ) 是指两个主机在通信时并不区分哪一个是服务请求方还是服务提供方

只要两个主机都运行了对等连接软件 ( P2P 软件) ，它们就可以进行**平等的、对等连接通信**。双方都可以下载对方已经存储在硬盘中的共享文档

在 P2P 网络中，每个节点 **既可以从其他节点得到服务，也可以向其他节点提供服务**。最突出的的特点之一就是它的 **可拓展性**，当系统每增加一个对等方时，不仅增加的是服务的请求者，同时也增加了服务的提供者， **系统性能不会因规模的扩大而降低**

> 更多关于 P2P：[P2P 技术原理](http://www.360doc.com/content/14/0305/17/8285430_357987074.shtml)，或 [备份](../Summary/P2P_backup.md)、 [P2P 通信原理及其实现](https://evilpan.com/2015/10/31/p2p-over-middle-box/)

### 进程通信

而在构建网络应用程序前，还需要了解到 **运行在多个端系统的程序是如何互相通信的**。实际上进行通信的是 **进程(process)**，而不是程序，每一个运行的程序可以看做是一个进程

在两个不同端系统上的程序（如客户端上的浏览器，服务器上的处理程序），通过跨越计算机网络 **交换报文(message)** 而相互通信。如在浏览网页时，浏览器会向服务器发送获取网页数据的 **请求报文**；经过一系列传输后，服务器接收报文并处理后向浏览器发送 **响应报文** 和数据

在发送或接收报文之前，浏览器还得知道要 **如何发送和接收**，以及 **报文接收方的地址**：

#### 报文发送的出入口

进程发送接收报文之前，得通过一个叫做 **套接字(socket)** 的软件接口才能向网络发送和接收报文。程序开发者可以通过 Socket 控制报文的应用层的一切

#### 进程寻址

两个主机的进程之间想要通信，接收进程需要一个地址，包含了： 1. 主机的地址、2. 在目的主机中指定接收进程的标识符。在计网上这分别为 **IP 地址** 和 **端口号**

### 应用层协议

在发送报文之前，必须要知道该怎么去构造报文，进程要什么时候发送报文。这就必须有一个统一的规范—— **应用层协议**，它定义了：

- 交换的报文类型，如请求还是响应
- 各种报文的语法，如报文的各个字段的描述
- 字段的语义
- 发送报文的时间、对报文的响应规则

每一个不同的应用都有其对应的协议，就按 **万维网 WWW**、**多媒体网络（音视频等）**、**文件传送 FTP 和 P2P 文件共享**、**电子邮件**、**域名解析** 等来讲吧
