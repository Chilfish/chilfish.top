---
title: 链路层
date: 2023-02-28
tags: [note, net]
---

### 交换机地址表自学习和转发算法

交换机是计算机网络中常用的设备之一，主要用于在局域网内进行数据包转发。交换机通过学习源 MAC 地址和端口号的映射关系，建立地址表，实现对数据包的快速转发。其中，交换机地址表自学习和转发算法是实现交换机数据包转发的关键技术

#### 地址表自学习

交换机通过学习源 MAC 地址和端口号的映射关系，建立地址表，实现对数据包的快速转发。具体而言，当交换机收到一个数据包时，它会查看数据包中的源 MAC 地址，并将这个地址和数据包的输入端口记录在地址表中

然后，当交换机接收到另一个数据包时，它会再次查看数据包中的源 MAC 地址，并在地址表中查找该地址对应的端口。如果找到了该端口，则交换机将数据包直接发送到该端口。如果找不到该端口，则交换机将广播数据包到所有端口，以便寻找目标设备并更新地址表

#### 转发算法

交换机的转发算法是指它在接收到一个数据包后如何决定将数据包转发到哪个端口。交换机转发数据包的过程分为两个步骤：

- 首先，交换机会查看数据包中的目的 MAC 地址，并在地址表中查找该地址对应的端口。如果找到了该端口，则交换机将数据包直接发送到该端口。如果找不到该端口，则交换机将广播数据包到所有端口，以便寻找目标设备并更新地址表

- 其次，交换机会更新地址表，将源 MAC 地址和端口号的映射关系记录在地址表中，以便下次快速转发数据包

总之，交换机地址表自学习和转发算法是交换机实现局域网内数据包快速转发的关键技术。通过自学习建立地址表，交换机可以快速找到数据包对应的端口并进行转发；而通过转发算法的优化，交换机可以避免广播风暴和提高数据包转发的效率

#### 丢弃数据包

交换机可能会在以下情况下选择丢弃数据包而不是转发：

- **端口发生拥塞**：当一个交换机端口接收到的数据包数量超过了它所支持的最大带宽，交换机就会发生拥塞。为了防止拥塞蔓延到整个网络中，交换机可以选择丢弃一些数据包以减轻网络负载

- **数据包长度超过 MTU** ：当交换机接收到的数据包长度超过了该网络所支持的最大传输单元 (MTU) 时，交换机可能会选择丢弃该数据包，因为它不能分割该数据包并转发到其他网络

- **目标设备无法到达**：如果交换机无法将数据包转发到目标设备，例如该设备已断开连接或故障，交换机可能会选择丢弃该数据包，以避免浪费网络资源

在这些情况下，交换机通常会向发送端发送一个丢包通知，告诉发送端数据包已经被丢弃，以便发送端可以重新发送该数据包或执行其他纠错操作
